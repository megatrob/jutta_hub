<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
 <link rel="stylesheet" href="index.css">
    <title>Document</title>
</head>
<body>

    <div class="selling">
        <nav>
          <h2 class="logo">Jutta<span> Hub</span></h2>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="sneakers.html">Products</a></li>
            <li><a href="#">About</a></li>
            <li><a href="#">Service</a></li>
            <li><a href="sell.html">Sell</a></li>
          </ul>

          <div class="registration">
            <button id="login-btn" data-bs-toggle="modal" data-bs-target="#loginModal">Login/Register</button></div>
        </nav>
      
         
        </div>

        <!-- Login Modal -->
<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="loginModalLabel">Welcome Back</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <!-- Your login/register form goes here -->
          <form onsubmit="loginUser(); return false;">
            <div class="mb-3">
              <label for="login-username" class="form-label">Username</label>
              <input type="text" class="form-control" id="login-username" placeholder="Enter your username">
            </div>
            <div class="mb-3">
              <label for="login-password" class="form-label">Password</label>
              <input type="password" class="form-control" id="login-password" placeholder="Enter your password" autocomplete="off">
            </div>
            <p>Don't have an account? <a href="#" data-bs-toggle="modal" data-bs-target="#registerModal">Register</a></p>  
          
            <button type="submit" class="btn btn-primary">Login</button>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

<!-- Register Modal -->
<div class="modal fade" id="registerModal" tabindex="-1" aria-labelledby="registerModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="registerModalLabel">Register</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <!-- Your registration form goes here -->
          <form id="registrationForm" action="/register" method="POST">
            <div class="mb-3">
              <label for="register-username" class="form-label">Username</label>
              <input type="text" class="form-control" id="register-username" name="username" placeholder="Enter your username">
            </div>
            <div class="mb-3">
              <label for="register-email" class="form-label">Email</label>
              <input type="email" class="form-control" id="register-email" name="email" placeholder="Enter your email">
            </div>
            <div class="mb-3">
              <label for="register-password" class="form-label">Password</label>
              <input type="password" class="form-control" id="register-password" name="password" placeholder="Enter your password">
            </div>
            <div class="mb-3">
              <label for="confirm-password" class="form-label">Confirm Password</label>
              <input type="password" class="form-control" id="confirm-password" name="confirmPassword" placeholder="Confirm your password">
            </div>
            <p>Already have an account <a href="#" data-bs-toggle="modal" data-bs-target="#loginModal">Login Here</a></p>
            <!-- Display success message -->
            <div id="registrationSuccessMessage" class="alert alert-success d-none">
              Registration successful. You can now log in.
            </div>
            <button type="button" class="btn btn-primary" onclick="registerUser()">Register</button>
          </form>
          
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>



<div class="container  my-5">
<h1 class="text-center">Sell your product </h1>

<div class="sell my-5">
    <form action="/submit" method="post" enctype="multipart/form-data">
        <label for="shoes-name">Shoes name:</label>
        <input type="text" id="shoeName" name="shoeName" required>
    
        <label for="brand">Brand:</label>
        <select id="brand" name="brand" required>
            <option value="adidas">Adidas</option>
            <option value="nike">Nike</option>
            <option value="other">Other</option>
        </select>
    
        <label for="shoePhoto">Shoe Photo:</label>
        <input type="file" id="shoePhoto" name="shoePhoto" accept="image/*" required>
    
        <label for="shoePrice">Price:</label>
        <input type="number" id="shoePrice" name="shoePrice" min="0" required>
        <button type="button" onclick="submitSellForm()">Submit</button>
        <a class="text-end" href="index.html">Go back to Homepage</a>
    </form>
</div>
</div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
    <!-- Add this script block in the head or at the end of your HTML file -->
<script>
    function registerUser() {
  
      // Add a global variable to store the entered username
  let enteredUsername = '';
  window.onload = function () {
      const loggedInUsername = localStorage.getItem('loggedInUsername');
      if (loggedInUsername) {
        // If logged in, update the navbar with the username
        updateNavbarForUser(loggedInUsername);
      }
    };
      // Get form data
      const username = document.getElementById('register-username').value;
      const email = document.getElementById('register-email').value;
      const password = document.getElementById('register-password').value;
      const confirmPassword = document.getElementById('confirm-password').value;
  
      // Validate the data
      if (!username || !email || !password || !confirmPassword) {
        alert('All fields are required');
        return;
      }
  
      // Additional validation (you can customize this based on your requirements)
      if (password !== confirmPassword) {
        alert('Passwords do not match');
        return;
      }
  
      // Prepare the data for submission
      const formData = {
        username: username,
        email: email,
        password: password,
        confirmPassword: confirmPassword
      };
  
      // Make an AJAX request to submit the data
      fetch('/register', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(formData),
      })
      .then(response => response.json())
      .then(data => {
        console.log('Success:', data);
        // Optionally, you can display a success message or redirect after successful registration
        if (data.success) {
          // Display success message (you can customize this based on your HTML structure)
          alert('Registration successful. You can now log in.');
        }
      })
      .catch((error) => {
        console.error('Error:', error);
      });
    }
  
   // Modify the login form submission logic
  function loginUser() {
    // Get form data
    const username = document.getElementById('login-username').value;
    const password = document.getElementById('login-password').value;
  
    // Validate the data
    if (!username || !password) {
      alert('Both username and password are required');
      return;
    }
  
    // Prepare the data for submission
    const formData = {
      username: username,
      password: password
    };
  
      // Make an AJAX request to submit the login data
      fetch('/login', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(formData),
    })
    .then(response => response.json())
    .then(data => {
      console.log('Response:', data);
      if (data.success) {
        // Update the navbar with user info and hide the login button
        enteredUsername = formData.username; // Store the entered username
        updateNavbarForUser(enteredUsername);
        // Optionally, you can redirect or perform other actions after successful login
        redirectToHome();
      } else {
        alert('Invalid username or password. Please try again.');
      }
    })
    .catch((error) => {
      console.error('Error:', error);
    });
  }
  
  // New function to update the navbar for the logged-in user
  function updateNavbarForUser(username) {
    const registrationDiv = document.querySelector('.registration');
    const userInfoDiv = document.getElementById('user-info');
  
    // Replace the existing registration div with the new div
    registrationDiv.innerHTML = `<div class="registration">
      <button id="login-btn" >
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
          <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"></path>
          <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"></path>
        </svg> ${username}
      </button>
    </div>`;
  
    // Optionally, you can add other logic or styling based on your needs
  
    // Display user info (you can customize this based on your needs)
    userInfoDiv.innerHTML = `<span class="user-icon">👤</span> ${username}`;
    userInfoDiv.style.display = 'inline-block';
  }
  // New function to update the navbar for the logged-in user
  function updateNavbarForUser(username) {
    const registrationDiv = document.querySelector('.registration');
    const userInfoDiv = document.getElementById('user-info');
  
    // Store the username in localStorage
    localStorage.setItem('loggedInUsername', username);
  
    // Replace the existing registration div with the new div
    registrationDiv.innerHTML = `<div class="registration">
      <button id="login-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
          <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"></path>
          <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"></path>
        </svg> ${username}
      </button>
    </div>`;
  
    // Optionally, you can add other logic or styling based on your needs
  
    // Display user info (you can customize this based on your needs)
    userInfoDiv.innerHTML = `<span class="user-icon">👤</span> ${username}`;
    userInfoDiv.style.display = 'inline-block';




    
  }
  

        function submitSellForm() {
            // Get form data
            const shoeName = document.getElementById('shoeName').value;
            const brand = document.getElementById('brand').value;
            const shoePhoto = document.getElementById('shoePhoto').files[0]; // Assuming a single file is selected
            const shoePrice = document.getElementById('shoePrice').value;

            // Prepare FormData to handle file uploads
            const formData = new FormData();
            formData.append('shoeName', shoeName);
            formData.append('brand', brand);
            formData.append('shoePhoto', shoePhoto);
            formData.append('shoePrice', shoePrice);

            // Make a fetch request to your server to handle data submission
            fetch('/submit', {
                method: 'POST',
                body: formData,
            })
            .then(response => response.json())
            .then(data => {
                console.log('Response:', data);
                // Optionally, you can handle success or show a message
            })
            .catch((error) => {
                console.error('Error:', error);
            });
        }
    </script>
</body>
</html>